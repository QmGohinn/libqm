##  第一章

##### 网络测试和故障诊断的定义与目的

三个要素：测试方法、测试环境、测试工具

##### 网络管理的根本目的

给网络用户提供更好的服务

##### 用户关心

网络性能 + 网络服务质量

网络性能：动态变化 需要进行 网络测试

网络服务质量：需要对网络传输中的各个节点进行测试分析  

##### 网络测试和故障诊断的体系划分

功能体系：数据采集、数据管理、数据分析、数据表示

结构体系： 元 / 流

##### 数据采集模块

主动采集、被动采集

##### 数据管理模块

预处理和存储、要求做到标准化

##### 数据分析模块

后续分析

主要功能：数据统计分析、事件分析

##### 数据表示模块(人机接口)

把数据图形化或者怎么样提供给使用者看

##### 元

代表网络中的节点：网线、网卡、交换机、 路由器、主机和服务器 架构

##### 流

在网路中的数据 可以是 比特流、数据帧流、分组流、应用流

#### 元的纵向分析

##### 物理层的元分析

构成网络的硬件基础是光、电和无线介质，以及各类接口和设备板卡线路。

测试主要对象是双绞线和光纤

测试主要内容是：连通性、线序、长度等规范性内容，同时包含干扰和衰减等参数

##### 链路层元分析

测试的主要内容：链路传输速率、背靠背、丢包率、时延和吞吐量等，同时有协议的匹配性和设备的兼容性，也。括交换机的MAC地址表

##### 网络层和传输层的元分析

测试的主要对象:网络设备，如三层交换机和路由设备及其他设备，测试主要围绕协议和会话，也包括流缓存表等。

主要内容是：最大吞吐量、最大并发用户、 最大连接速率、最大并发连接数、最大带宽和 最大事务速率

##### 应用层的元分析

网络中采用的应用协议不同，测试项目的有关参数一般需要重新定义。

在应用层的测试中，由于应用数量的不断增长和更新，使得这一层的分析最为复杂，需要结合实际应用内容建立测试模型，定制测试方法



## 第二章

### 常用网络流量分析管理系统

##### SNMP架构的网管系统

SNMP是一种简单Request/Response协议

网络管理系统发出一个请求，被管理设备返回响应

由Get、GetNext、Set 和Trap 四种协议操作组成

SNMP系列软件中的多路由流量图形绘制器（MRTG）是代表性软件，采用SNMP协议访问具有SNMP代理的网络设备，生成图形化的界面，便于使用者查看，安装简便，容易定制

##### NetFlow架构的网络流量分析系统

是一种用于IP流量信息收集的网络协议，是流量监控的行业标准。最初开发用于分组交换路径选择，使路由器转发过程更高效。

经过多年的技术发展，NetFlow对流经网络设备的IP数据流进行测量和统计的功能得到不断完善，并成为互联网领域公认的最主要的流量分析、统计和计费的行业标准。

NetFlow技术能对IP/MPLS网络的通信流量进行详细的行为模式分析和计量，并提供网络运行的详细统计数据

NetFlow系统的三个主要部分

•探测器：监听网络数据

•采集器：收集探测器传来的数据

•报告系统：将从采集器收集到的数据生成易读的报告

采集器和报告系统通常位于一台服务器中。

##### NetFlow与SNMP的区别

  SNMP在网络设备中是低优先级的功能，如果网络繁忙，路由器可能会停止响应信息请求，导致在最需要数据的时候发生数据丢失

  NetFlow的工作方式是不间断发布，只负责将记录发出，存储流信息则交给其他NetFlow采集设备，不会造成严重的网络拥塞

  NetFlow的缺点是开放性不够

##### 自采集架构流量分析系统

  NetFlow架构的分析精细度强于SNMP架构，但对于实际网络分析来说，还是不够，如需进行精细和全面的流量分析必须要采集所有的原始数据包，存储后，供后续分析处理

  需采用探针加控制台的设计模式，探针集成了比较丰富的功能，可以进行线速捕包，同时具有非常大的存储空间，可在本地存储数据和运行分析报告

  探针有时更像具备了高处理性能和高存储容量的协议分析软件

##### 探针分类

###### •分布式协议分析探针

在大型网络中存在大量出口链路，管理者需对广域出口等关键链路实施24小时的全程监控，在各广域链路出口部署探针，进行分布式网络流量统计，数据中心的服务器分析或存储分布式协议分析探针采集的数据。

###### •海量存储协议分析系统

主要是针对数据中心，数据中心的高速率和巨大的数据量，要求协议分析系统不仅需要具备线速协议捕捉分析能力，还需要具备快速数据还原和提取功能。

海量存储协议分析系统拥有海量的记录空间，也有经过优化的数据存储技术和数据读取技术。



## 第三章

##### 物理层测试内容

包括传输介质和传输设备俩个部分

##### 多模光纤

用于建筑物内或地理位置相邻的环境中

##### 单模光纤

被大量用于建筑物间或者远距离的传输

##### WLAN的网络结构

###### Ad-hot

允许各设备之间直接进行通信

###### 基础设施模式

由无线接入点AP、无线站点STA和分布式系统DS组成

###### 多AP模式

由多个AP和DS组成的基础设施模式网络

###### 无线网桥模式

采用一对AP以网桥模式连通俩段DS

###### 无线中继器模式

采用类似接力方式进行信号延申

##### WLAN和有线网络物理层的区别

WLAN没有绝对的边界、WLAN无法避免外界信号干扰

WLAN可靠性低、WLAN拓扑结构经常是动态的、WLAN缺乏全连通性、需要严密的安全加密手段

WLAN具有时变特性和非对称传播特性

#####  网络物理层的测试之综合布线系统

布线系统包括“传输介质、相关连接硬件以及电气保护设备

通过这些部件来构成布线系统中各种子系统

(工作区子系统、水平子系统、垂直子系统、设备间子系统、管理子系统、建筑与建筑群子系统)

##### 水平子系统

一般采用超5类或6类双绞线，少量使用多模光纤作为水平链路；

##### 垂直子系统

一般多用多模光纤或单模光纤；

##### 建筑与建筑群子系统

一般采用单模光纤

#### 水平子系统的测试标准和参数

##### 光纤测试标准和参数

##### P.44 一级测试（为了用于确保高质量的网络性能和完整性）

1.验证光纤长度

2.验证极性

3.测量整个光纤链路的衰减，判断是否小于指定的损耗值

#####  二级测试（P.52 P.64  在一级测试的基础上加测一些内容：OTDR）

T2 = T1 + OTDR + limit

一级测试用于验收评估，二级测试用于故障判断

##### OTDR技术

1 Rayleigh散射 P.54

2 Fresnel反射   P.57

### OTDR测试主要内容：

##### 1 事件测试

距离、损耗、反射

##### 2 光纤端测试

段长度、段损耗或者损耗系数、段回波损耗

##### 3 整个链路测试

总链路长度、总链路损耗、总链路段回波损耗

### OTDR知识点

1 OTDR测试仅进行单端测试，另一端不能有光发射信号

2 OTDR测试仪的最远测试距离是通过计算得到，但要根据工程情况加以一定的经验修正

3 动态范围对OTDR最远测试距离影响最大，同样性能的OTDR，动态范围定义不同，实际测量值也不同

4 测试量程是在Trace曲线图上显示的最大距离，如果测试时曲线图没有显示出末端时间，则需加大测试量程

5 OTDR的自动模式适合普通测量，手动模式适合精确测量

6 手动测试时选择距离一般是实际距离的1.5～2倍

##### 无线局域网物理层测试的内容

1 WLAN频谱分析：面临ISM频段其他设备的干扰

2 信号强度分析：终端距离AP越远，信号越差；终端实际接收信号强度越弱，数据传输速率越低。

3 无线信道分析：相邻无线小区要错开信道，同一信道内的SSID数量需要控制。

4 AP容量分析：预先设计和规划AP的承载用户数。

##### 无线信号覆盖的评估测试 P.72

部署方式

分析方式



## 第四章

##### 有线链路层概述

数据链路层位于OSI 7层模型中的第2层，为网络层提供服务，数据链路层以帧的方式传输信号，提高了网络传输可靠性。

数据链路层最基本的服务是将源地址网络层数据可靠地传输到相邻节点的目标地址网络层

##### 数据链路层的功能

1 将数据组成帧

2 控制帧在物理链路上的传输

3 处理传输差错

4 调节发送速率与接收方的速率相匹配

5 在俩个网络实体之间提供数据链路通路的建立、维护和释放的管理

##### 帧的种类

1 FCS错误

2 Runt错误

3 Fragment错误

4 Alignment对齐错误

5 Dribble错误

6 Oversize错误

7 Jabber错误

8 Collision碰撞

9 幻象帧

##### 交换机转发方式

1 存储转发

优点

缺点

2 直接转发 (快速转发)

优点

缺点

3 碎片隔离式转发(改进了直接转发，位于存储转发和直接转发)

##### 无线数据链路层概述

MAC帧头部中的帧控制字段将无线MAC帧分为三类：

数据帧：用户的数据报文

控制帧：协助发送数据帧的控制报文，控制何时发送以及何时回应

管理帧：负责站点和AP之间的功能型交互，进行认证和关联等管理工作

##### 有线数据链路层故障分类

1 帧错误

2 配置错误

3 性能及功能故障 P.98

主动测试

被动测试

##### 无线数据链路层故障分类

1 性能类问题导致的故障 

a  信道过载

① AP关联的客户端过多，会发生AP关联表溢出

② 带宽利用率过高

b 信道上的多播帧和广播帧过多

2 攻击类问题导致的故障

a 拒绝服务攻击(终端阻塞)

b 拒绝服务攻击(阻塞AP)

##### 性能评估环境中的测试

性能评估环境中的部署方式

性能评估环境中的分析方式 



## 第五章

##### RFC1242概述

为网络互连设备的基准测试定义了基本术语和概念

**背靠背**、恒定负载、数据链路帧大小、**丢包率**、帧间空隙、**延迟**、重启行为、**吞吐量**

##### RFC2544概述

•最初目的时为网桥和路由器的基准测试提高方法，随网络技术的发展，其通用测试理论和方法对网络2-7层性能的衡量都有重要指导作用。

•不仅适用于目前几乎所有的2~3层设备和网络的测试，如交换机、路由器、防火墙、VPN等，也适用于各种类型和拓扑的网络。

被称为网络测试的“圣经”

最主要内容是基准测试。从测试目标、测试过程、测试报告格式等方面详细描述了六个性能的基准测试。

1 吞吐量

2 丢包率

3 延迟

4 背靠背

5 系统恢复

6 重启

##### 三层网络测试

•实际应用中，根据测试目的不同，有针对性选取被测指标。

•尽管第三层测试技术指标的定义中以包为关注对象，但由于每一个包都必须经过第二层封装才能传输，即每个数据包都存在一个与之对应的帧，因此，在第三层测试中仍以帧为对象定义每条测试流量。

##### 吞吐量：

定义：在网络空载和无丢包条件下链路能够达到的最大数据转发速率。

测试目的：找到在没有丢包的情况下路由器能够转发的最大速率。

零丢包是判定吞吐量的唯一标准。



整机吞吐量：被测设备的整体转发能力

反映背板或者交换网络的能力



端口吞吐量：被测设备对某种单一应用的支持程度

反映端口和线卡的能力

##### 测试方法

p.116



##### 丢包率

定义：是网络性能造成数据帧无法被转发的比例

测试目的：确定DUT在不同的负载和帧长度条件下的丢包率。

三种测试流量模式：

1 一对端口发送和接收

2 部分网状多对一端口测试

3 多对多全网状测试

测试方法  p122

1 吞吐量未知的情况下

2 已知吞吐量的情况



##### 延迟

延迟是衡量路由器性能的重要指标之一

延迟是基准测试的重点

测试目的：确定数据包经过DUT传输所需要的时间

反映DUT执行转发操作的速度以及转发队列的处理情况，延迟越小，说明路由器处理数据包的速度越快

必测参数：

(1) 输入帧的最后一位到达输入端口的时刻；

(2) 输出帧的第一位出现在输出端口的时刻。

每个帧的开始标记和结束标志是相同的，直接得到这两个参数在工程上不可能。

测试方法 P127



##### 背对背帧

定义： 是测量远端设备处理背靠背帧的能力

背靠背值：是远端单元能够处理且不丢失任何帧时的最长脉冲串中帧的数量。

测试目的：通过向被测设备发送具有合法最小帧间隙的突发数据包，确定被测设备在不丢包的情况下能够处理的最大数据包数目，从而考察路由器接口对于突发数据的缓存能力。

##### 背对背测试和吞吐量测试

1 区别

2 联系

##### 测试方法 P133



##### 网络层故障分类

1 地址分配故障

2 地址解析故障

3 路由故障

##### 有关术语

链路：一条由线路和传输路径组成的网络通信信道

等等   //P162

##### OSPF路由器类型 P166

1 内部路由器

2 主干路由器

3 区域边界路由器

4 自治系统边界路由器

##### OSPF链路的类型

1 点到点链路

2 广播多路访问链路

​    传输网络

​	末节网络

3 区域间链路

4 外部自治系统间链路

5 非广播多路访问链路

6 虚链路

##### OSPF基本配置 P172

##### OSPF虚链接配置 P189



## 第六章

##### 传输层故障分类

1 延迟问题

2 丢包问题

##### TCP的六种扫描方式

1 Connect扫描

2 SYN扫描

3 FIN扫描

4 ACK扫描

5 NULL扫描

6 Xmas Tree扫描

##### UDP扫描方式

向目标设备端口发送一个内容为空的UDP报文，如果目标端口回应的是ICMP端口不可达消息，说明该端口关闭，如果收到一个表示错误的消息，说明目标端口开放存在服务

网络进行UDP扫描其数据能否传达或接收依赖于网络和设备系统的繁忙程度，测试结果并不可靠

最为常用的检查端口状态的工具是Telnet命令，通过该命令登录远程服务器的端口，从而判断端口是否处于打开状态

Telnet命令是运用TCP扫描中的第一种类型TCP connect来完成端口的访问



## 第七章

##### 应用层测试分析

##### 数据格式

1 原始数据

2 流格式数据

##### 应用协议分析中的关键技术

1 多级架构
